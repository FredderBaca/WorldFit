<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Worldfit</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/feather-icons"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
@keyframes scaleIn {
  from { transform: scale(0); opacity: 0; }
  to { transform: scale(1); opacity: 1; }
}
@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}
.animate-scaleIn { animation: scaleIn 0.4s ease forwards; }
.animate-fadeIn { animation: fadeIn 0.3s ease forwards; }
</style>

</head>
<body class="bg-gray-100">

  <div class="flex h-screen">

    <aside id="sidebar" class="fixed md:static top-0 left-0 h-full w-64 bg-gray-900 text-white flex flex-col transform -translate-x-full md:translate-x-0 transition-transform duration-300 z-50">
      <div class="px-6 py-4 flex justify-between items-center ">
        <img id="closeSidebar" src="../src/imagenes/Logo.png">
        </button>
      </div>

      <div class="flex flex-col items-center py-6 border-b border-gray-700">
        <img src="../src/imagenes/perfil.png" alt="perfil" class="w-20 h-20 rounded-full border-2 border-red-500">
        <h2 class="mt-2 font-semibold">Admin GYM</h2>
        <span class="text-sm text-gray-400">Entrenador</span>
      </div>

      <div class="px-4 py-2">
        <input id="searchInput" type="text" placeholder="Buscar..." class="w-full px-3 py-2 rounded bg-gray-800 text-sm text-white focus:outline-none focus:ring-2 focus:ring-red-500">

      </div>

      <nav class="flex-1 px-2 py-4 space-y-2">
        <a href="#" class="bg-red-600 flex items-center px-4 py-2 rounded hover:bg-red-800 transition">
          <i data-feather="home" class="w-5 h-5 mr-3"></i> Inicio
        </a>
        <a href="productos.html" class="flex items-center px-4 py-2 hover:bg-gray-800 rounded">
          <i data-feather="shopping-cart" class="w-5 h-5 mr-3"></i> Productos
        </a>
        <a href="#" class="flex items-center px-4 py-2 hover:bg-gray-800 rounded">
          <i data-feather="user-plus" class="w-5 h-5 mr-3"></i> Registro
        </a>
        <a href="#" class="flex items-center px-4 py-2 hover:bg-gray-800 rounded">
          <i data-feather="settings" class="w-5 h-5 mr-3"></i> Administración
        </a>
        <a href="#" class="flex items-center px-4 py-2 hover:bg-gray-800 rounded">
          <i data-feather="user" class="w-5 h-5 mr-3"></i> Cuenta
        </a>
      </nav>
    </aside>

    <div class="flex-1 flex flex-col">

      <header class="bg-white shadow px-6 py-4 flex justify-between items-center">
        <button id="openSidebar" class="md:hidden">
          <i data-feather="menu" class="w-6 h-6"></i>
        </button>
        <div class="flex items-center space-x-3 ml-auto">
          <div><img class="w-8 h-8 rounded-full" src="../src/imagenes/perfil.png"></div>
          <span>User</span>
          <span class="w-2 h-2 bg-red-500 rounded-full"></span>
        </div>
      </header>

      <main class="flex-1 p-6 space-y-6 overflow-y-auto">

        <section class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
          <div  id="btnRegistrar" class="bg-white p-6 rounded-xl shadow flex items-center justify-between border-t-4 border-red-600 cursor-pointer">
            <div>
              <h3 class="text-lg font-bold">Registrar</h3>
              <p class="text-gray-500">Nuevos registros</p>
            </div>
            <i data-feather="user-plus" class="w-10 h-10 text-red-600"></i>
          </div>
          <div class="bg-white p-6 rounded-xl shadow flex items-center justify-between border-t-4 border-green-600 cursor-pointer">
            <div>
              <h3 class="text-lg font-bold">Renovar</h3>
              <p class="text-gray-500">Renovaciones</p>
            </div>
            <i data-feather="refresh-ccw" class="w-10 h-10 text-green-600"></i>
          </div>
          <div class="bg-white p-6 rounded-xl shadow flex items-center justify-between border-t-4 border-yellow-500">
            <div>
              <h3 class="text-lg font-bold">Membresías Pendientes</h3>
              <p class="text-gray-500">20 pendientes</p>
            </div>
            <i data-feather="clock" class="w-10 h-10 text-yellow-500"></i>
          </div>
          <div class="bg-white p-6 rounded-xl shadow flex items-center justify-between border-t-4 border-red-500">
            <div>
              <h3 class="text-lg font-bold">Membresías Expiradas</h3>
              <p class="text-gray-500">5 expiradas</p>
            </div>
            <i data-feather="alert-triangle" class="w-10 h-10 text-red-500"></i>
          </div>
          <div class="bg-white p-6 rounded-xl shadow flex items-center justify-between border-t-4 border-blue-600">
            <div>
              <h3 class="text-lg font-bold">Miembros Activos</h3>
              <p class="text-gray-500">150 activos</p>
            </div>
            <i data-feather="users" class="w-10 h-10 text-blue-600"></i>
          </div>
          <div class="bg-white p-6 rounded-xl shadow flex items-center justify-between border-t-4 border-gray-700">
            <div>
              <h3 class="text-lg font-bold">Productos</h3>
              <p class="text-gray-500">35 en stock</p>
            </div>
            <i data-feather="package" class="w-10 h-10 text-gray-700"></i>
          </div>
        </section>

        <section class="bg-white p-6 rounded-xl shadow">
          <h3 class="text-lg font-bold mb-4">Resumen de Membresías</h3>
          <canvas id="membershipChart"></canvas>
        </section>

        <section class="grid grid-cols-1 lg:grid-cols-2 gap-6">
          <div class="bg-white p-6 rounded-xl shadow">
            <h3 class="text-lg font-bold mb-2">Últimos Registros</h3>
            <ul class="space-y-2">
              <li class="flex justify-between"><span>Juan Pérez</span><span class="text-green-600">Activo</span></li>
              <li class="flex justify-between"><span>Ana López</span><span class="text-yellow-600">Pendiente</span></li>
              <li class="flex justify-between"><span>Mario Gómez</span><span class="text-red-600">Expirado</span></li>
            </ul>
          </div>
          <div class="bg-white p-6 rounded-xl shadow">
            <h3 class="text-lg font-bold mb-2">Productos más vendidos</h3>
            <ul class="space-y-2">
              <li class="flex justify-between"><span>Proteína Whey</span><span>120 ventas</span></li>
              <li class="flex justify-between"><span>Creatina</span><span>85 ventas</span></li>
              <li class="flex justify-between"><span>Pre-entreno</span><span>60 ventas</span></li>
            </ul>
          </div>
        </section>

      </main>
    </div>
  </div>

<div id="modalRegistro" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
  <div class="bg-white p-6 rounded-xl w-96 shadow-lg border-red-500 max-h-[90vh] overflow-y-auto">
    <div class="flex justify-center mb-2">
      <img src="../src/imagenes/Logo.png" alt="Logo" width="200px" height="200px">
    </div>
    <h2 class="text-xl font-bold mb-4 text-center">Registrar Miembro</h2>

    <form id="formRegistro" class="space-y-3">
      <div>
        <label class="block text-sm font-medium text-gray-700">Nombre</label>
        <input type="text" id="nombre" class="w-full p-2 border rounded-lg focus:ring-2 focus:ring-red-500" required>
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700">Teléfono</label>
        <input type="text" id="telefono" class="w-full p-2 border rounded-lg focus:ring-2 focus:ring-red-500" required>
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700">Ingrese fecha de inicio</label>
        <input type="date" id="fechaInicio" class="w-full p-2 border rounded-lg focus:ring-2 focus:ring-red-500">
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700">Tipo de Membresía</label>
        <select id="tipoMembresia" class="w-full p-2 border rounded-lg focus:ring-2 focus:ring-red-500">
          <option value="dia">Día</option>
          <option value="semana">Semana</option>
          <option value="quincena">Quincena</option>
          <option value="mes">Mes</option>
          <option value="personalizada">Personalizada</option>
        </select>
      </div>

      <div id="personalizado" class="hidden">
        <label class="block text-sm font-medium text-gray-700">Ingrese fin de membresía</label>
        <input type="date" id="fechaFin" class="w-full p-2 border rounded-lg focus:ring-2 focus:ring-red-500 mb-2">
        <label class="block text-sm font-medium text-gray-700">Ingrese precio</label>
        <input type="number" id="precioPersonalizado" class="w-full p-2 border rounded-lg focus:ring-2 focus:ring-red-500" placeholder="Ej. 350">
      </div>

      <div id="resumenFechas" class="text-sm text-gray-700 bg-gray-100 p-3 rounded-lg">
        <p>Inicio: <span id="inicioVal">00/00/00</span></p>
        <p>Fin: <span id="finVal">00/00/00</span></p>
        <p>Total: $<span id="totalVal">0</span></p>
      </div>

      <div class="flex justify-between mt-4">
        <button type="button" id="btnCancelar" class="px-4 py-2 bg-gray-300 rounded-lg hover:bg-gray-400">Cancelar</button>
        <button type="submit" class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700">Guardar</button>
      </div>
    </form>
  </div>
</div>

<div id="modalRenovar" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
  <div class="bg-white p-6 rounded-xl w-[420px] shadow-lg border-green-600 max-h-[90vh] overflow-y-auto">
    <div class="flex justify-center mb-2">
      <img src="../src/imagenes/Logo.png" alt="Logo" width="180">
    </div>
    <h2 class="text-xl font-bold mb-4 text-center">Renovar Membresía</h2>

    <div id="busquedaUsuario">
      <label class="block text-sm font-medium text-gray-700">Buscar usuario</label>
      <input type="text" id="buscarUsuarioInput" class="w-full p-2 border rounded-lg focus:ring-2 focus:ring-green-500" placeholder="Nombre o teléfono">
      <div class="flex justify-between mt-3">
        <button id="btnBuscarUsuario" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700">Buscar</button>
        <button id="btnCancelarRenovar" class="px-4 py-2 bg-gray-300 rounded-lg hover:bg-gray-400">Cancelar</button>
      </div>

      <div id="resultadosUsuarios" class="mt-4 space-y-2"></div>
    </div>

    <div id="datosUsuario" class="hidden mt-4">
      <div class="bg-gray-100 p-3 rounded-lg mb-4">
        <p><strong>Nombre:</strong> <span id="usuarioNombre"></span></p>
        <p><strong>Teléfono:</strong> <span id="usuarioTelefono"></span></p>
        <p><strong>Estado:</strong> <span id="usuarioEstado" class="font-semibold"></span></p>
        <p><strong>Días restantes:</strong> <span id="usuarioDias"></span></p>
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700">Renovar por</label>
        <select id="tipoRenovacion" class="w-full p-2 border rounded-lg focus:ring-2 focus:ring-green-500">
          <option value="semana">Semana</option>
          <option value="quincena">Quincena</option>
          <option value="mes">Mes</option>
          <option value="personalizada">Personalizada</option>
        </select>
      </div>

      <div id="renovacionPersonalizada" class="hidden mt-3">
        <label class="block text-sm font-medium text-gray-700">Ingrese fecha de inicio</label>
        <input type="date" id="fechaInicioRenovacion" class="w-full p-2 border rounded-lg focus:ring-2 focus:ring-green-500 mb-2">
        <label class="block text-sm font-medium text-gray-700">Ingrese fecha final</label>
        <input type="date" id="fechaFinRenovacion" class="w-full p-2 border rounded-lg focus:ring-2 focus:ring-green-500 mb-2">
        <label class="block text-sm font-medium text-gray-700">Ingrese monto</label>
        <input type="number" id="montoPersonalizado" placeholder="Ej. 400" class="w-full p-2 border rounded-lg focus:ring-2 focus:ring-green-500">
      </div>

      <div class="bg-gray-100 mt-4 p-3 rounded-lg text-sm">
        <p><strong>Total:</strong> $<span id="totalRenovacion">0</span></p>
      </div>

      <div class="flex justify-between mt-4">
        <button id="btnAtrasBusqueda" class="px-4 py-2 bg-gray-300 rounded-lg hover:bg-gray-400">Atrás</button>
        <button  type="submit"  id="btnConfirmarRenovacion" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700">Guardar</button>
      </div>
    </div>
  </div>
</div>

<div id="successAnimation" class="hidden fixed inset-0 flex items-center justify-center bg-black bg-opacity-40 z-50">
  <div class="bg-white p-6 rounded-2xl shadow-lg flex flex-col items-center animate-fadeIn">
    <svg class="w-16 h-16 text-green-500 animate-scaleIn" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7" />
    </svg>
    <p id="successMessage" class="mt-3 text-lg font-semibold text-green-600">Acción Exitosa</p>
  </div>
</div>


  <script>
    feather.replace();

    const sidebar = document.getElementById("sidebar");
    const openBtn = document.getElementById("openSidebar");
    const closeBtn = document.getElementById("closeSidebar");

    openBtn.addEventListener("click", () => {
      sidebar.classList.remove("-translate-x-full");
    });
    closeBtn.addEventListener("click", () => {
      sidebar.classList.add("-translate-x-full");
    });

    // Chart.js
    const ctx = document.getElementById('membershipChart').getContext('2d');
    new Chart(ctx, {
      type: 'bar',
      data: {
        labels: ['Activos', 'Expiradas', 'Pendientes'],
        datasets: [{
          label: 'Miembros',
          data: [150, 5, 20],
          backgroundColor: ['#16a34a','#ef4444','#f59e0b'],
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: { display: false }
        }
      }
    });


    //busqueda 
    // --- Búsqueda y redirección ---
const searchInput = document.getElementById("searchInput");

searchInput.addEventListener("keypress", function (e) {
  if (e.key === "Enter") {
    e.preventDefault();
    const query = searchInput.value.trim();
    if (query) {
      window.location.href = `busqueda.html?q=${encodeURIComponent(query)}`;
    }
  }
});

//--- MODAL REGISTRO ---
const modal = document.getElementById("modalRegistro");
const btnRegistrar = document.getElementById("btnRegistrar");
const btnCancelar = document.getElementById("btnCancelar");
const tipoMembresia = document.getElementById("tipoMembresia");
const personalizado = document.getElementById("personalizado");
const fechaInicio = document.getElementById("fechaInicio");
const fechaFin = document.getElementById("fechaFin");
const precioPersonalizado = document.getElementById("precioPersonalizado");
const inicioVal = document.getElementById("inicioVal");
const finVal = document.getElementById("finVal");
const totalVal = document.getElementById("totalVal");

// --- MODIFICADO: Constantes para la animación de éxito ---
const successAnim = document.getElementById("successAnimation");
const successMessage = document.getElementById("successMessage");


btnRegistrar.addEventListener("click", () => modal.classList.remove("hidden"));
btnCancelar.addEventListener("click", () => modal.classList.add("hidden"));

tipoMembresia.addEventListener("change", actualizarResumen);
fechaInicio.addEventListener("change", actualizarResumen);
fechaFin.addEventListener("change", actualizarResumen);
precioPersonalizado.addEventListener("input", actualizarResumen);

function actualizarResumen() {
  inicioVal.textContent = fechaInicio.value
    ? new Date(fechaInicio.value + 'T00:00:00').toLocaleDateString() // Ajuste para zona horaria
    : "00/00/00";

  if (tipoMembresia.value === "personalizada") {
    personalizado.classList.remove("hidden");
    finVal.textContent = fechaFin.value
      ? new Date(fechaFin.value + 'T00:00:00').toLocaleDateString()
      : "00/00/00";
    totalVal.textContent = precioPersonalizado.value || "0";
  } else {
    personalizado.classList.add("hidden");
    let inicio = fechaInicio.value ? new Date(fechaInicio.value + 'T00:00:00') : new Date();
    let fin = new Date(inicio);
    let total = 0;
    switch (tipoMembresia.value) {
      case "dia": fin.setDate(inicio.getDate() + 1); total = 50; break;
      case "semana": fin.setDate(inicio.getDate() + 7); total = 200; break;
      case "quincena": fin.setDate(inicio.getDate() + 15); total = 250; break;
      case "mes": fin.setMonth(inicio.getMonth() + 1); total = 500; break;
    }
    finVal.textContent = fin.toLocaleDateString();
    totalVal.textContent = total;
  }
}

// ✅ Animación al guardar (Registro)
document.getElementById("formRegistro").addEventListener("submit", (e) => {
  e.preventDefault();
  modal.classList.add("hidden");
  
  // MODIFICADO: Establecer mensaje y mostrar animación
  successMessage.textContent = "Registro Exitoso";
  successAnim.classList.remove("hidden");

  setTimeout(() => {
    successAnim.classList.add("hidden");
    e.target.reset();
    personalizado.classList.add("hidden");
    totalVal.textContent = "0";
    inicioVal.textContent = "00/00/00";
    finVal.textContent = "00/00/00";
  }, 2000);
});





//--- MODAL RENOVAR ---
const modalRenovar = document.getElementById("modalRenovar");
const btnRenovarCard = document.querySelector(".border-t-4.border-green-600"); 
const btnCancelarRenovar = document.getElementById("btnCancelarRenovar");
const btnBuscarUsuario = document.getElementById("btnBuscarUsuario");
const buscarUsuarioInput = document.getElementById("buscarUsuarioInput");
const resultadosUsuarios = document.getElementById("resultadosUsuarios");
const datosUsuario = document.getElementById("datosUsuario");
const busquedaUsuario = document.getElementById("busquedaUsuario");
const tipoRenovacion = document.getElementById("tipoRenovacion");
const renovacionPersonalizada = document.getElementById("renovacionPersonalizada");
const totalRenovacion = document.getElementById("totalRenovacion");
const btnAtrasBusqueda = document.getElementById("btnAtrasBusqueda");
const btnConfirmarRenovacion = document.getElementById("btnConfirmarRenovacion");

// Datos de ejemplo
const usuariosEjemplo = [
  { nombre: "Cesar Bermudez", telefono: "555123456", estado: "activa", dias: 12 },
  { nombre: "Ana López", telefono: "555987654", estado: "vencida", dias: 0 },
  { nombre: "Mario Gómez", telefono: "555321999", estado: "activa", dias: 5 },
];

// Abrir modal
btnRenovarCard.addEventListener("click", () => {
  modalRenovar.classList.remove("hidden");
});

// Cerrar modal
btnCancelarRenovar.addEventListener("click", () => {
  modalRenovar.classList.add("hidden");
  limpiarRenovacion();
});

// Buscar usuarios (simulado)
btnBuscarUsuario.addEventListener("click", () => {
  const query = buscarUsuarioInput.value.trim().toLowerCase();
  resultadosUsuarios.innerHTML = "";

  const resultados = usuariosEjemplo.filter(u =>
    u.nombre.toLowerCase().includes(query) || u.telefono.includes(query)
  );

  if (resultados.length === 0) {
    resultadosUsuarios.innerHTML = `<p class="text-gray-500 text-sm">No se encontraron usuarios.</p>`;
    return;
  }

  resultados.forEach(usuario => {
    const div = document.createElement("div");
    div.className = "p-2 border rounded hover:bg-green-100 cursor-pointer";
    div.textContent = `${usuario.nombre} - ${usuario.telefono}`;
    div.addEventListener("click", () => mostrarDatosUsuario(usuario));
    resultadosUsuarios.appendChild(div);
  });
});

// Mostrar datos del usuario
function mostrarDatosUsuario(usuario) {
  busquedaUsuario.classList.add("hidden");
  datosUsuario.classList.remove("hidden");

  document.getElementById("usuarioNombre").textContent = usuario.nombre;
  document.getElementById("usuarioTelefono").textContent = usuario.telefono;
  document.getElementById("usuarioEstado").textContent =
    usuario.estado === "activa" ? "Membresía Activa" : "Membresía Vencida";
  document.getElementById("usuarioEstado").className =
    usuario.estado === "activa" ? "text-green-600 font-semibold" : "text-red-600 font-semibold";
  document.getElementById("usuarioDias").textContent = usuario.dias;
}

// Atrás a búsqueda
btnAtrasBusqueda.addEventListener("click", () => {
  datosUsuario.classList.add("hidden");
  busquedaUsuario.classList.remove("hidden");
  buscarUsuarioInput.value = "";
  resultadosUsuarios.innerHTML = "";
  totalRenovacion.textContent = "0";
  renovacionPersonalizada.classList.add("hidden");
});

// Tipo de renovación
tipoRenovacion.addEventListener("change", actualizarTotal);

function actualizarTotal() {
  let total = 0;
  const tipo = tipoRenovacion.value;

  if (tipo === "personalizada") {
    renovacionPersonalizada.classList.remove("hidden");
    total = document.getElementById("montoPersonalizado").value || 0;
  } else {
    renovacionPersonalizada.classList.add("hidden");
    switch (tipo) {
      case "semana": total = 200; break;
      case "quincena": total = 250; break;
      case "mes": total = 500; break;
    }
  }
  totalRenovacion.textContent = total;
}

document.getElementById("montoPersonalizado").addEventListener("input", actualizarTotal);

// --- MODIFICADO: Confirmar renovación ahora usa la animación ---
btnConfirmarRenovacion.addEventListener("click", () => {
  // Ocultar modal de renovación
  modalRenovar.classList.add("hidden");

  // Personalizar y mostrar la animación de éxito
  successMessage.textContent = "Renovación Exitosa";
  successAnim.classList.remove("hidden");

  // Ocultar la animación después de 2 segundos y limpiar
  setTimeout(() => {
    successAnim.classList.add("hidden");
    limpiarRenovacion();
  }, 2000);
});

function limpiarRenovacion() {
  datosUsuario.classList.add("hidden");
  busquedaUsuario.classList.remove("hidden");
  buscarUsuarioInput.value = "";
  resultadosUsuarios.innerHTML = "";
  totalRenovacion.textContent = "0";
  renovacionPersonalizada.classList.add("hidden");
}

  </script>
</body>
</html>